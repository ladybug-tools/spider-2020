<!doctype html>
<html lang="en" >
<head>
<meta charset="utf-8" >
<title>Open Index or Markdown</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain" >
<meta name="description" content="File wrangler. Default index.html file. Opens HTML or Markdown files. Passes location.hash." >
<meta name="keywords" content="ShowDown,Markdown,AJAX,JavaScript,HTML,CSS,GitHub,FOSS" >

</head>
<body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js" ></script>

	<link rel="stylesheet" href="./lib/style/style-2020-07-04.css">

	<div id=divContent ></div>

<script>

// https://github.com/showdownjs/showdown

	defaultFile = "README.md";
	
	//location.hash = "../assets/markdown-help.md"; // test
	//location.hash = "../assets/style.css"

	init();

	function init() {

		showdown.setFlavor("github");

		if ( ! location.hash ) { location.hash = defaultFile; }

		location.hash.endsWith( ".md" ) ? onHashChange() : window.location.href = location.hash;

		window.addEventListener( "hashchange", onHashChange, false );

	}

	function onHashChange() {

		const url = location.hash.slice( 1 );
		document.title = url.split( "/" ).pop();
		const options = { excludeTrailingPunctuationFromURLs: true, ghMention: true, simplifiedAutoLink: true, simpleLineBreaks: true, emoji: true, openLinksInNewWindow: true };


		const xhr = new XMLHttpRequest();
		xhr.open( "get", url, true );
		xhr.onload = () => {
			const txt = xhr.responseText.replace( /\<!--@@@/, "").replace( /\@@@-->/, "");
			divContent.innerHTML = new showdown.Converter( options ).makeHtml( txt );
		}
		xhr.send( null );

	}

</script>
</body>
</html>